{"version":3,"file":"index.min.js","mappings":"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","sources":["webpack://k6-jslib-utils/webpack/bootstrap","webpack://k6-jslib-utils/webpack/runtime/compat get default export","webpack://k6-jslib-utils/webpack/runtime/define property getters","webpack://k6-jslib-utils/webpack/runtime/hasOwnProperty shorthand","webpack://k6-jslib-utils/webpack/runtime/make namespace object","webpack://k6-jslib-utils/external commonjs \"k6/crypto\"","webpack://k6-jslib-utils/external commonjs \"k6/execution\"","webpack://k6-jslib-utils/./src/stages.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"k6/crypto\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"k6/execution\");","import exec from 'k6/execution'\n\n// parseDuration parses the provided string as an Integer number\n// in millisecond precision\nfunction parseDuration(str) {\n\tif (str == null || str.length < 1) {\n\t\tthrow new Error('str is empty')\n\t}\n\n\t// the sum in millisecond of the parsed duration\n\tlet d = 0;\n\n\t// current contains the partial seen number\n\t// it's reset when a time unit is found\n\tlet current = '';\n\n\t\n\t// it tracks the seen time units\n\t// and it denies eventual duplicated\n\tlet seen = {}\n\n\tfor (let i = 0; i < str.length; i++) {\n\t\t// append the current char if it's a number or a decimal separator\n\t\tif (isNumber(str[i]) || str[i] == '.') {\n\t\t\tcurrent += str[i]\n\t\t}\n\n\t\t// return if the next char is not a time unit \n\t\tif (str[i+1] == null || isNumber(str[i+1]) || str[i+1] == '.') {\n\t\t\tcontinue\n\t\t}\n\t\n\t\tlet v = parseFloat(current, 10)\n\t\tlet next = str[i+1]\n\t\t\n\t\tswitch (next) {\n\t\t\tcase 'd':\n\t\t\t\td += v*24*60*60*1000\n\t\t\t\tbreak;\n\t\t\tcase 'h':\n\t\t\t\td += v*60*60*1000\n\t\t\t\tbreak;\n\t\t\tcase 'm':\n\t\t\t\tif (i + 2 < str.length && str[i+2] == 's') {\n\t\t\t\t\t// millisecond is the maximum precision\n\t\t\t\t\t// truncate eventual decimal\n\t\t\t\t\td += Math.trunc(v)\n\t\t\t\t\ti++\n\t\t\t\t\tnext = 'ms'\n\t\t\t\t} else {\n\t\t\t\t\td += v*60*1000\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 's':\n\t\t\t\td += v*1000\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthrow new Error(`${next} is an unsupported time unit`)\n\t\t}\n\t\tif (seen[next]) {\n\t\t\tthrow new Error(`${next} time unit is provided multiple times`)\n\t\t}\n\t\tseen[next] = true\n\t\ti++\n\t\tcurrent = ''\n\t}\n\t// flush in case no time unit has been provided\n\t// for the latest group\n\tif (current.length > 0) {\n\t\td += parseFloat(current, 10)\n\t}\n\treturn d \n}\n\n// isNumber return true if the c character is a number\nfunction isNumber(c) {\n\treturn c >= '0' && c <= '9'\n}\n\n// getCurrentStageIndex returns the computed index of the running stage.\nfunction getCurrentStageIndex() {\n\tlet scenario = exec.test.options.scenarios[exec.scenario.name]\n\tif (scenario == null)\t{\n\t\tthrow new Error(`the exec.test.options object doesn't contain the current scenario ${exec.scenario.name}`)\n\t}\n\tif (scenario.stages == null) {\n\t\tthrow new Error(`only ramping-vus or ramping-arravial-rate supports stages, it is not possible to get a stage index on other executors.`)\n\t}\n\n\tif (scenario.stages.length < 1) {\n\t\tthrow new Error(`the current scenario ${scenario.name} doesn't contain any stage`)\n\t}\n\n\tlet sum = 0;\n\tlet elapsed = new Date() - exec.scenario.startTime\n\tfor (let i = 0; i < scenario.stages.length; i++) {\n\t\tsum += parseDuration(scenario.stages[i].duration)\n\t\tif (elapsed < sum) {\n\t\t\treturn i\n\t\t}\n\t}\n\n\treturn scenario.stages.length-1\n}\n\n// tagWithCurrentStageIndex adds a tag with a `stage` key\n// and the index of the current running stage as value.\nfunction tagWithCurrentStageIndex() {\n  exec.vu.tags['stage'] = getCurrentStageIndex()\n}\n\n// tagWithCurrentStageProfile adds a tag with a `stage` key\n// and the profile (ramp-up, steady or ramp-down) computed\n// from the current running stage.\nfunction tagWithCurrentStageProfile() {\n  //ramp-up when previous.target < current.target\n  //ramp-down when previous.target > current.target\n  //steady when prevuious.target = current.target\n\t\n\tlet getStageProfile = function() {\t\n\t\tlet currentIndex = getCurrentStageIndex()\n\t\tif (currentIndex < 1) {\n\t\t\treturn 'ramp-up'\n\t\t}\n\n\t\tlet stages = exec.test.options.scenarios[exec.scenario.name].stages\n\t\tlet current = stages[currentIndex]\n\t\tlet previous = stages[currentIndex-1] \n\n\t\tif (current.target  > previous.target) {\n\t\t\treturn 'ramp-up'\n\t\t}\n\t\t\n\t\tif (previous.target == current.target) {\n\t\t\treturn 'steady'\n\t\t}\n\n\t\treturn 'ramp-down'\n\t}\n\n  exec.vu.tags['stage_profile'] = getStageProfile()\n}\n\nexport {\n\tparseDuration,\n\tgetCurrentStageIndex,\n\ttagWithCurrentStageIndex,\n\ttagWithCurrentStageProfile,\n}\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","require","parseDuration","str","length","Error","current","seen","i","isNumber","v","parseFloat","next","Math","trunc","c","getCurrentStageIndex","scenario","exec","stages","name","sum","elapsed","Date","duration","tagWithCurrentStageIndex","tagWithCurrentStageProfile","currentIndex","previous","target","getStageProfile"],"sourceRoot":""}
